{% extends "base.html" %}

{% block title %}ML Model Training - Claude Insight{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-12">
        <h2 class="mb-0">
            <i class="fas fa-brain me-2"></i>Machine Learning Model Training
        </h2>
        <p class="text-muted mt-2">Train, evaluate, and deploy custom ML models for advanced analytics</p>
    </div>
</div>

<!-- Training Wizard Progress -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card border-0 shadow-sm">
            <div class="card-body p-4">
                <div class="wizard-progress">
                    <div class="wizard-step active" data-step="1">
                        <div class="wizard-step-number">1</div>
                        <div class="wizard-step-label">Model Selection</div>
                    </div>
                    <div class="wizard-step" data-step="2">
                        <div class="wizard-step-number">2</div>
                        <div class="wizard-step-label">Data Upload</div>
                    </div>
                    <div class="wizard-step" data-step="3">
                        <div class="wizard-step-number">3</div>
                        <div class="wizard-step-label">Configure</div>
                    </div>
                    <div class="wizard-step" data-step="4">
                        <div class="wizard-step-number">4</div>
                        <div class="wizard-step-label">Train</div>
                    </div>
                    <div class="wizard-step" data-step="5">
                        <div class="wizard-step-number">5</div>
                        <div class="wizard-step-label">Evaluate</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Main Content Area -->
<div class="row">
    <div class="col-lg-8">
        <!-- Step 1: Model Selection -->
        <div class="wizard-content" id="step1" style="display: block;">
            <div class="card border-0 shadow-sm mb-4">
                <div class="card-header bg-white border-0 pt-4 pb-3">
                    <h5 class="mb-0">
                        <i class="fas fa-robot me-2"></i>Select Model Type
                    </h5>
                </div>
                <div class="card-body p-4">
                    <div class="row g-3">
                        <!-- Anomaly Detection Models -->
                        <div class="col-md-4">
                            <div class="model-card" onclick="selectModelCategory('anomaly')">
                                <div class="model-icon">
                                    <i class="fas fa-exclamation-triangle fa-3x text-warning"></i>
                                </div>
                                <h6 class="mt-3">Anomaly Detection</h6>
                                <p class="text-muted small">Detect unusual patterns and outliers</p>
                                <div class="model-types">
                                    <span class="badge bg-secondary">Isolation Forest</span>
                                    <span class="badge bg-secondary">LOF</span>
                                    <span class="badge bg-secondary">One-Class SVM</span>
                                </div>
                            </div>
                        </div>

                        <!-- Time Series Forecasting -->
                        <div class="col-md-4">
                            <div class="model-card" onclick="selectModelCategory('forecasting')">
                                <div class="model-icon">
                                    <i class="fas fa-chart-line fa-3x text-primary"></i>
                                </div>
                                <h6 class="mt-3">Time Series Forecasting</h6>
                                <p class="text-muted small">Predict future values and trends</p>
                                <div class="model-types">
                                    <span class="badge bg-secondary">ARIMA</span>
                                    <span class="badge bg-secondary">Prophet</span>
                                    <span class="badge bg-secondary">LSTM</span>
                                </div>
                            </div>
                        </div>

                        <!-- Classification -->
                        <div class="col-md-4">
                            <div class="model-card" onclick="selectModelCategory('classification')">
                                <div class="model-icon">
                                    <i class="fas fa-tags fa-3x text-success"></i>
                                </div>
                                <h6 class="mt-3">Classification</h6>
                                <p class="text-muted small">Categorize data into classes</p>
                                <div class="model-types">
                                    <span class="badge bg-secondary">Random Forest</span>
                                    <span class="badge bg-secondary">XGBoost</span>
                                    <span class="badge bg-secondary">Neural Net</span>
                                </div>
                            </div>
                        </div>

                        <!-- Regression -->
                        <div class="col-md-4">
                            <div class="model-card" onclick="selectModelCategory('regression')">
                                <div class="model-icon">
                                    <i class="fas fa-chart-area fa-3x text-info"></i>
                                </div>
                                <h6 class="mt-3">Regression</h6>
                                <p class="text-muted small">Predict continuous values</p>
                                <div class="model-types">
                                    <span class="badge bg-secondary">Linear Regression</span>
                                    <span class="badge bg-secondary">Ridge/Lasso</span>
                                    <span class="badge bg-secondary">SVR</span>
                                </div>
                            </div>
                        </div>

                        <!-- Clustering -->
                        <div class="col-md-4">
                            <div class="model-card" onclick="selectModelCategory('clustering')">
                                <div class="model-icon">
                                    <i class="fas fa-project-diagram fa-3x text-danger"></i>
                                </div>
                                <h6 class="mt-3">Clustering</h6>
                                <p class="text-muted small">Group similar data points</p>
                                <div class="model-types">
                                    <span class="badge bg-secondary">K-Means</span>
                                    <span class="badge bg-secondary">DBSCAN</span>
                                    <span class="badge bg-secondary">Hierarchical</span>
                                </div>
                            </div>
                        </div>

                        <!-- Custom Model -->
                        <div class="col-md-4">
                            <div class="model-card" onclick="selectModelCategory('custom')">
                                <div class="model-icon">
                                    <i class="fas fa-code fa-3x text-secondary"></i>
                                </div>
                                <h6 class="mt-3">Custom Model</h6>
                                <p class="text-muted small">Upload your own trained model</p>
                                <div class="model-types">
                                    <span class="badge bg-secondary">PyTorch</span>
                                    <span class="badge bg-secondary">TensorFlow</span>
                                    <span class="badge bg-secondary">Scikit-learn</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Specific Model Selection (appears after category selection) -->
                    <div id="specificModelSelection" style="display: none;" class="mt-4">
                        <hr>
                        <h6 class="mb-3">Select Specific Model:</h6>
                        <div id="modelOptions" class="row g-3">
                            <!-- Dynamic model options will be inserted here -->
                        </div>
                    </div>

                    <div class="mt-4 d-flex justify-content-between">
                        <button class="btn btn-outline-secondary" disabled>
                            <i class="fas fa-arrow-left me-2"></i>Previous
                        </button>
                        <button class="btn btn-primary" onclick="nextStep(2)" id="step1Next" disabled>
                            Next<i class="fas fa-arrow-right ms-2"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Step 2: Data Upload -->
        <div class="wizard-content" id="step2" style="display: none;">
            <div class="card border-0 shadow-sm mb-4">
                <div class="card-header bg-white border-0 pt-4 pb-3">
                    <h5 class="mb-0">
                        <i class="fas fa-database me-2"></i>Training Data
                    </h5>
                </div>
                <div class="card-body p-4">
                    <!-- Data Source Selection -->
                    <div class="mb-4">
                        <label class="form-label fw-bold">Data Source</label>
                        <div class="btn-group w-100" role="group">
                            <input type="radio" class="btn-check" name="dataSource" id="uploadData" autocomplete="off" checked onchange="showDataSourceOptions('upload')">
                            <label class="btn btn-outline-primary" for="uploadData">
                                <i class="fas fa-upload me-2"></i>Upload File
                            </label>

                            <input type="radio" class="btn-check" name="dataSource" id="useSystemData" autocomplete="off" onchange="showDataSourceOptions('system')">
                            <label class="btn btn-outline-primary" for="useSystemData">
                                <i class="fas fa-server me-2"></i>Use System Data
                            </label>

                            <input type="radio" class="btn-check" name="dataSource" id="connectApi" autocomplete="off" onchange="showDataSourceOptions('api')">
                            <label class="btn btn-outline-primary" for="connectApi">
                                <i class="fas fa-plug me-2"></i>Connect API
                            </label>
                        </div>
                    </div>

                    <!-- Upload File Option -->
                    <div id="uploadDataSection">
                        <div class="upload-zone" id="uploadZone">
                            <i class="fas fa-cloud-upload-alt fa-3x mb-3 text-primary"></i>
                            <h6>Drag & Drop your data file here</h6>
                            <p class="text-muted">or click to browse</p>
                            <input type="file" id="dataFileInput" accept=".csv,.json,.xlsx" style="display: none;">
                            <button class="btn btn-primary mt-2" onclick="document.getElementById('dataFileInput').click()">
                                <i class="fas fa-folder-open me-2"></i>Browse Files
                            </button>
                            <small class="text-muted d-block mt-2">Supported: CSV, JSON, Excel (Max 100MB)</small>
                        </div>

                        <!-- File Preview -->
                        <div id="filePreview" style="display: none;" class="mt-3">
                            <div class="alert alert-success">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <i class="fas fa-file-alt me-2"></i>
                                        <strong id="fileName"></strong>
                                        <small class="text-muted ms-2" id="fileSize"></small>
                                    </div>
                                    <button class="btn btn-sm btn-outline-danger" onclick="removeFile()">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>

                            <!-- Data Preview Table -->
                            <div class="card mt-3">
                                <div class="card-header bg-light">
                                    <h6 class="mb-0">Data Preview</h6>
                                </div>
                                <div class="card-body p-0">
                                    <div class="table-responsive" style="max-height: 300px;">
                                        <table class="table table-sm mb-0" id="dataPreviewTable">
                                            <thead class="table-light" id="dataHeaders"></thead>
                                            <tbody id="dataRows"></tbody>
                                        </table>
                                    </div>
                                </div>
                                <div class="card-footer bg-light">
                                    <small class="text-muted">
                                        <strong id="rowCount">0</strong> rows Ã— <strong id="colCount">0</strong> columns
                                    </small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- System Data Option -->
                    <div id="systemDataSection" style="display: none;">
                        <div class="mb-3">
                            <label class="form-label">Select Data Source</label>
                            <select class="form-select" id="systemDataSource">
                                <option value="">-- Choose System Data --</option>
                                <option value="logs">System Logs (Performance data)</option>
                                <option value="metrics">Metrics History (CPU, Memory, etc.)</option>
                                <option value="alerts">Alert History</option>
                                <option value="sessions">Session Data</option>
                                <option value="performance">Performance Profiling Data</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Date Range</label>
                            <div class="row g-2">
                                <div class="col-6">
                                    <input type="date" class="form-control" id="systemDataStartDate">
                                </div>
                                <div class="col-6">
                                    <input type="date" class="form-control" id="systemDataEndDate">
                                </div>
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="loadSystemData()">
                            <i class="fas fa-download me-2"></i>Load Data
                        </button>
                    </div>

                    <!-- API Connection Option -->
                    <div id="apiDataSection" style="display: none;">
                        <div class="mb-3">
                            <label class="form-label">API Endpoint URL</label>
                            <input type="url" class="form-control" id="apiEndpoint" placeholder="https://api.example.com/data">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Authentication Method</label>
                            <select class="form-select" id="apiAuthMethod">
                                <option value="none">No Authentication</option>
                                <option value="bearer">Bearer Token</option>
                                <option value="apikey">API Key</option>
                                <option value="basic">Basic Auth</option>
                            </select>
                        </div>
                        <div class="mb-3" id="apiAuthDetails" style="display: none;">
                            <label class="form-label">API Key / Token</label>
                            <input type="password" class="form-control" id="apiAuthValue" placeholder="Enter your API key or token">
                        </div>
                        <button class="btn btn-primary" onclick="connectToAPI()">
                            <i class="fas fa-plug me-2"></i>Connect & Fetch Data
                        </button>
                    </div>

                    <!-- Data Validation -->
                    <div id="dataValidation" style="display: none;" class="mt-4">
                        <hr>
                        <h6 class="mb-3">Data Validation</h6>
                        <div class="row g-3">
                            <div class="col-md-4">
                                <div class="validation-card">
                                    <div class="validation-icon">
                                        <i class="fas fa-check-circle text-success fa-2x"></i>
                                    </div>
                                    <h6 class="mt-2">Format Valid</h6>
                                    <small class="text-muted">Data structure is correct</small>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="validation-card">
                                    <div class="validation-icon">
                                        <i class="fas fa-exclamation-triangle text-warning fa-2x" id="missingValuesIcon"></i>
                                    </div>
                                    <h6 class="mt-2">Missing Values</h6>
                                    <small class="text-muted" id="missingValuesText">0 missing values detected</small>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="validation-card">
                                    <div class="validation-icon">
                                        <i class="fas fa-chart-bar text-info fa-2x"></i>
                                    </div>
                                    <h6 class="mt-2">Data Quality</h6>
                                    <small class="text-muted" id="dataQualityText">Excellent (95%)</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-4 d-flex justify-content-between">
                        <button class="btn btn-outline-secondary" onclick="prevStep(1)">
                            <i class="fas fa-arrow-left me-2"></i>Previous
                        </button>
                        <button class="btn btn-primary" onclick="nextStep(3)" id="step2Next" disabled>
                            Next<i class="fas fa-arrow-right ms-2"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Step 3: Configure Hyperparameters -->
        <div class="wizard-content" id="step3" style="display: none;">
            <div class="card border-0 shadow-sm mb-4">
                <div class="card-header bg-white border-0 pt-4 pb-3">
                    <h5 class="mb-0">
                        <i class="fas fa-sliders-h me-2"></i>Configure Hyperparameters
                    </h5>
                </div>
                <div class="card-body p-4">
                    <!-- Train/Test Split -->
                    <div class="mb-4">
                        <label class="form-label fw-bold">Train/Test Split</label>
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label class="form-label small">Training Data (%)</label>
                                <input type="range" class="form-range" min="50" max="90" value="80" id="trainSplitRange" oninput="updateSplitDisplay()">
                                <div class="d-flex justify-content-between">
                                    <small class="text-muted">50%</small>
                                    <strong id="trainSplitValue">80%</strong>
                                    <small class="text-muted">90%</small>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label small">Test Data (%)</label>
                                <input type="text" class="form-control" id="testSplitValue" value="20%" readonly>
                            </div>
                        </div>
                    </div>

                    <!-- Model-Specific Hyperparameters -->
                    <div id="hyperparametersSection">
                        <!-- Dynamic hyperparameters based on selected model -->
                    </div>

                    <!-- Cross-Validation -->
                    <div class="mb-4">
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="enableCV" onchange="toggleCVOptions()">
                            <label class="form-check-label fw-bold" for="enableCV">
                                Enable Cross-Validation
                            </label>
                        </div>
                        <div id="cvOptions" style="display: none;" class="mt-3">
                            <label class="form-label small">Number of Folds</label>
                            <select class="form-select" id="cvFolds">
                                <option value="3">3-Fold</option>
                                <option value="5" selected>5-Fold</option>
                                <option value="10">10-Fold</option>
                            </select>
                        </div>
                    </div>

                    <!-- Auto-Optimization -->
                    <div class="mb-4">
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="enableAutoOptimization" onchange="toggleAutoOptimization()">
                            <label class="form-check-label fw-bold" for="enableAutoOptimization">
                                Enable Auto-Optimization (Grid Search)
                            </label>
                        </div>
                        <div id="autoOptimizationOptions" style="display: none;" class="mt-3">
                            <label class="form-label small">Optimization Method</label>
                            <select class="form-select" id="optimizationMethod">
                                <option value="grid">Grid Search</option>
                                <option value="random">Random Search</option>
                                <option value="bayesian">Bayesian Optimization</option>
                            </select>
                        </div>
                    </div>

                    <div class="mt-4 d-flex justify-content-between">
                        <button class="btn btn-outline-secondary" onclick="prevStep(2)">
                            <i class="fas fa-arrow-left me-2"></i>Previous
                        </button>
                        <button class="btn btn-primary" onclick="nextStep(4)">
                            Next<i class="fas fa-arrow-right ms-2"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Step 4: Train Model -->
        <div class="wizard-content" id="step4" style="display: none;">
            <div class="card border-0 shadow-sm mb-4">
                <div class="card-header bg-white border-0 pt-4 pb-3">
                    <h5 class="mb-0">
                        <i class="fas fa-play-circle me-2"></i>Train Model
                    </h5>
                </div>
                <div class="card-body p-4">
                    <!-- Training Summary -->
                    <div class="alert alert-info mb-4">
                        <h6 class="mb-2"><i class="fas fa-info-circle me-2"></i>Training Configuration Summary</h6>
                        <div class="row g-2">
                            <div class="col-md-6">
                                <small><strong>Model:</strong> <span id="summaryModel">-</span></small>
                            </div>
                            <div class="col-md-6">
                                <small><strong>Dataset:</strong> <span id="summaryDataset">-</span></small>
                            </div>
                            <div class="col-md-6">
                                <small><strong>Train/Test Split:</strong> <span id="summarySplit">-</span></small>
                            </div>
                            <div class="col-md-6">
                                <small><strong>Cross-Validation:</strong> <span id="summaryCV">-</span></small>
                            </div>
                        </div>
                    </div>

                    <!-- Training Control -->
                    <div class="text-center mb-4">
                        <button class="btn btn-success btn-lg" onclick="startTraining()" id="startTrainBtn">
                            <i class="fas fa-play me-2"></i>Start Training
                        </button>
                        <button class="btn btn-warning btn-lg" onclick="pauseTraining()" id="pauseTrainBtn" style="display: none;">
                            <i class="fas fa-pause me-2"></i>Pause Training
                        </button>
                        <button class="btn btn-danger btn-lg" onclick="stopTraining()" id="stopTrainBtn" style="display: none;">
                            <i class="fas fa-stop me-2"></i>Stop Training
                        </button>
                    </div>

                    <!-- Training Progress -->
                    <div id="trainingProgress" style="display: none;">
                        <h6 class="mb-3">Training Progress</h6>
                        <div class="mb-3">
                            <div class="d-flex justify-content-between mb-1">
                                <span class="small">Epoch <span id="currentEpoch">0</span> / <span id="totalEpochs">100</span></span>
                                <span class="small"><span id="epochPercent">0</span>%</span>
                            </div>
                            <div class="progress" style="height: 25px;">
                                <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%;" id="trainingProgressBar">
                                    0%
                                </div>
                            </div>
                        </div>

                        <!-- Training Metrics -->
                        <div class="row g-3 mb-4">
                            <div class="col-md-3">
                                <div class="metric-box">
                                    <small class="text-muted">Training Loss</small>
                                    <h5 class="mb-0" id="trainLoss">-</h5>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="metric-box">
                                    <small class="text-muted">Validation Loss</small>
                                    <h5 class="mb-0" id="valLoss">-</h5>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="metric-box">
                                    <small class="text-muted">Accuracy</small>
                                    <h5 class="mb-0" id="accuracy">-</h5>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="metric-box">
                                    <small class="text-muted">Time Elapsed</small>
                                    <h5 class="mb-0" id="timeElapsed">0s</h5>
                                </div>
                            </div>
                        </div>

                        <!-- Training Chart -->
                        <div class="card">
                            <div class="card-header bg-light">
                                <h6 class="mb-0">Loss Curve</h6>
                            </div>
                            <div class="card-body">
                                <canvas id="lossChart" height="80"></canvas>
                            </div>
                        </div>

                        <!-- Training Logs -->
                        <div class="card mt-3">
                            <div class="card-header bg-light">
                                <h6 class="mb-0">Training Logs</h6>
                            </div>
                            <div class="card-body p-0">
                                <div id="trainingLogs" class="training-logs">
                                    <div class="log-entry">[INFO] Waiting to start training...</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-4 d-flex justify-content-between">
                        <button class="btn btn-outline-secondary" onclick="prevStep(3)">
                            <i class="fas fa-arrow-left me-2"></i>Previous
                        </button>
                        <button class="btn btn-primary" onclick="nextStep(5)" id="step4Next" disabled>
                            Next<i class="fas fa-arrow-right ms-2"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Step 5: Evaluate Model -->
        <div class="wizard-content" id="step5" style="display: none;">
            <div class="card border-0 shadow-sm mb-4">
                <div class="card-header bg-white border-0 pt-4 pb-3">
                    <h5 class="mb-0">
                        <i class="fas fa-chart-bar me-2"></i>Model Evaluation
                    </h5>
                </div>
                <div class="card-body p-4">
                    <!-- Evaluation Metrics -->
                    <h6 class="mb-3">Performance Metrics</h6>
                    <div class="row g-3 mb-4">
                        <div class="col-md-3">
                            <div class="evaluation-metric">
                                <div class="metric-icon">
                                    <i class="fas fa-bullseye text-success"></i>
                                </div>
                                <h3 class="mb-0" id="evalAccuracy">-</h3>
                                <small class="text-muted">Accuracy</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="evaluation-metric">
                                <div class="metric-icon">
                                    <i class="fas fa-chart-line text-primary"></i>
                                </div>
                                <h3 class="mb-0" id="evalPrecision">-</h3>
                                <small class="text-muted">Precision</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="evaluation-metric">
                                <div class="metric-icon">
                                    <i class="fas fa-search text-info"></i>
                                </div>
                                <h3 class="mb-0" id="evalRecall">-</h3>
                                <small class="text-muted">Recall</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="evaluation-metric">
                                <div class="metric-icon">
                                    <i class="fas fa-balance-scale text-warning"></i>
                                </div>
                                <h3 class="mb-0" id="evalF1">-</h3>
                                <small class="text-muted">F1-Score</small>
                            </div>
                        </div>
                    </div>

                    <!-- Confusion Matrix -->
                    <div class="card mb-4">
                        <div class="card-header bg-light">
                            <h6 class="mb-0">Confusion Matrix</h6>
                        </div>
                        <div class="card-body">
                            <canvas id="confusionMatrixChart" height="100"></canvas>
                        </div>
                    </div>

                    <!-- ROC Curve -->
                    <div class="card mb-4">
                        <div class="card-header bg-light">
                            <h6 class="mb-0">ROC Curve (AUC: <span id="aucScore">-</span>)</h6>
                        </div>
                        <div class="card-body">
                            <canvas id="rocCurveChart" height="80"></canvas>
                        </div>
                    </div>

                    <!-- Feature Importance -->
                    <div class="card mb-4">
                        <div class="card-header bg-light">
                            <h6 class="mb-0">Feature Importance</h6>
                        </div>
                        <div class="card-body">
                            <canvas id="featureImportanceChart" height="80"></canvas>
                        </div>
                    </div>

                    <!-- Save Model -->
                    <div class="card border-success mb-4">
                        <div class="card-header bg-success text-white">
                            <h6 class="mb-0"><i class="fas fa-save me-2"></i>Save Trained Model</h6>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label class="form-label">Model Name</label>
                                <input type="text" class="form-control" id="modelName" placeholder="e.g., anomaly_detector_v1">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Description</label>
                                <textarea class="form-control" id="modelDescription" rows="2" placeholder="Brief description of the model"></textarea>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Tags (comma-separated)</label>
                                <input type="text" class="form-control" id="modelTags" placeholder="anomaly, production, v1">
                            </div>
                            <div class="d-flex gap-2">
                                <button class="btn btn-success" onclick="saveModel()">
                                    <i class="fas fa-save me-2"></i>Save Model
                                </button>
                                <button class="btn btn-outline-primary" onclick="exportModel()">
                                    <i class="fas fa-download me-2"></i>Export (Download)
                                </button>
                                <button class="btn btn-outline-info" onclick="deployModel()">
                                    <i class="fas fa-rocket me-2"></i>Deploy to Production
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="mt-4 d-flex justify-content-between">
                        <button class="btn btn-outline-secondary" onclick="prevStep(4)">
                            <i class="fas fa-arrow-left me-2"></i>Previous
                        </button>
                        <button class="btn btn-success" onclick="finishTraining()">
                            <i class="fas fa-check me-2"></i>Finish
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Sidebar: Quick Info & Saved Models -->
    <div class="col-lg-4">
        <!-- Quick Tips -->
        <div class="card border-0 shadow-sm mb-4">
            <div class="card-header bg-white border-0 pt-4 pb-3">
                <h6 class="mb-0">
                    <i class="fas fa-lightbulb me-2"></i>Quick Tips
                </h6>
            </div>
            <div class="card-body p-3">
                <div id="quickTips">
                    <div class="tip-item">
                        <i class="fas fa-check-circle text-success me-2"></i>
                        <small>Choose model based on your data type and goal</small>
                    </div>
                    <div class="tip-item">
                        <i class="fas fa-check-circle text-success me-2"></i>
                        <small>More training data usually leads to better results</small>
                    </div>
                    <div class="tip-item">
                        <i class="fas fa-check-circle text-success me-2"></i>
                        <small>Use cross-validation for robust evaluation</small>
                    </div>
                    <div class="tip-item">
                        <i class="fas fa-check-circle text-success me-2"></i>
                        <small>Monitor for overfitting (train vs val loss)</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Saved Models -->
        <div class="card border-0 shadow-sm mb-4">
            <div class="card-header bg-white border-0 pt-4 pb-3">
                <h6 class="mb-0">
                    <i class="fas fa-save me-2"></i>Saved Models
                </h6>
            </div>
            <div class="card-body p-3">
                <div id="savedModelsList" class="list-group list-group-flush">
                    <div class="text-center text-muted py-3">
                        <i class="fas fa-inbox fa-2x mb-2 opacity-25"></i>
                        <p class="small mb-0">No saved models yet</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Model Comparison -->
        <div class="card border-0 shadow-sm">
            <div class="card-header bg-white border-0 pt-4 pb-3">
                <h6 class="mb-0">
                    <i class="fas fa-balance-scale me-2"></i>Model Comparison
                </h6>
            </div>
            <div class="card-body p-3">
                <p class="small text-muted">Compare multiple trained models to find the best performer</p>
                <button class="btn btn-sm btn-outline-primary w-100" onclick="openModelComparison()">
                    <i class="fas fa-chart-bar me-1"></i>Compare Models
                </button>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.0.0/dist/chart.umd.min.js"></script>
<script>
// ML Training UI JavaScript
let currentStep = 1;
let selectedModelCategory = null;
let selectedModel = null;
let trainingData = null;
let trainingActive = false;
let trainingInterval = null;
let lossChart = null;

// Model configurations
const modelConfigurations = {
    anomaly: {
        'isolation_forest': { name: 'Isolation Forest', params: ['n_estimators', 'max_samples', 'contamination'] },
        'lof': { name: 'Local Outlier Factor', params: ['n_neighbors', 'contamination', 'metric'] },
        'one_class_svm': { name: 'One-Class SVM', params: ['kernel', 'nu', 'gamma'] }
    },
    forecasting: {
        'arima': { name: 'ARIMA', params: ['p', 'd', 'q', 'seasonal'] },
        'prophet': { name: 'Prophet (Facebook)', params: ['seasonality_mode', 'changepoint_prior_scale', 'seasonality_prior_scale'] },
        'lstm': { name: 'LSTM Neural Network', params: ['units', 'layers', 'dropout', 'epochs', 'batch_size'] }
    },
    classification: {
        'random_forest': { name: 'Random Forest', params: ['n_estimators', 'max_depth', 'min_samples_split'] },
        'xgboost': { name: 'XGBoost', params: ['n_estimators', 'learning_rate', 'max_depth', 'subsample'] },
        'neural_net': { name: 'Neural Network', params: ['layers', 'units', 'activation', 'dropout', 'epochs'] }
    },
    regression: {
        'linear': { name: 'Linear Regression', params: ['fit_intercept', 'normalize'] },
        'ridge': { name: 'Ridge Regression', params: ['alpha', 'fit_intercept'] },
        'svr': { name: 'Support Vector Regression', params: ['kernel', 'C', 'epsilon'] }
    },
    clustering: {
        'kmeans': { name: 'K-Means', params: ['n_clusters', 'init', 'max_iter'] },
        'dbscan': { name: 'DBSCAN', params: ['eps', 'min_samples', 'metric'] },
        'hierarchical': { name: 'Hierarchical Clustering', params: ['n_clusters', 'linkage', 'affinity'] }
    }
};

// Select model category
function selectModelCategory(category) {
    selectedModelCategory = category;

    // Remove active class from all cards
    document.querySelectorAll('.model-card').forEach(card => {
        card.classList.remove('active');
    });

    // Add active class to selected card
    event.currentTarget.classList.add('active');

    // Show specific model options
    showSpecificModels(category);

    // Enable next button
    document.getElementById('step1Next').disabled = false;
}

function showSpecificModels(category) {
    const modelOptions = document.getElementById('modelOptions');
    const specificSection = document.getElementById('specificModelSelection');

    if (category === 'custom') {
        specificSection.style.display = 'none';
        return;
    }

    const models = modelConfigurations[category];
    let html = '';

    for (const [key, config] of Object.entries(models)) {
        html += `
            <div class="col-md-6">
                <div class="specific-model-card" onclick="selectSpecificModel('${key}', '${category}')">
                    <h6>${config.name}</h6>
                    <small class="text-muted">${config.params.length} parameters</small>
                </div>
            </div>
        `;
    }

    modelOptions.innerHTML = html;
    specificSection.style.display = 'block';
}

function selectSpecificModel(modelKey, category) {
    selectedModel = modelKey;

    // Remove active from all specific model cards
    document.querySelectorAll('.specific-model-card').forEach(card => {
        card.classList.remove('active');
    });

    // Add active to selected
    event.currentTarget.classList.add('active');
}

// Wizard navigation
function nextStep(step) {
    // Hide current step
    document.getElementById(`step${currentStep}`).style.display = 'none';

    // Show next step
    document.getElementById(`step${step}`).style.display = 'block';

    // Update progress
    document.querySelectorAll('.wizard-step').forEach(s => s.classList.remove('active'));
    document.querySelector(`[data-step="${step}"]`).classList.add('active');

    currentStep = step;

    // Special handling for step 4 (summary)
    if (step === 4) {
        updateTrainingSummary();
    }
}

function prevStep(step) {
    nextStep(step);
}

// Data source handling
function showDataSourceOptions(source) {
    document.getElementById('uploadDataSection').style.display = source === 'upload' ? 'block' : 'none';
    document.getElementById('systemDataSection').style.display = source === 'system' ? 'block' : 'none';
    document.getElementById('apiDataSection').style.display = source === 'api' ? 'block' : 'none';
}

// File upload handling
document.getElementById('dataFileInput').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (file) {
        handleFileUpload(file);
    }
});

function handleFileUpload(file) {
    document.getElementById('fileName').textContent = file.name;
    document.getElementById('fileSize').textContent = `(${(file.size / 1024 / 1024).toFixed(2)} MB)`;
    document.getElementById('filePreview').style.display = 'block';
    document.getElementById('dataValidation').style.display = 'block';

    // Parse file (simplified - in production, use proper CSV/JSON parser)
    const reader = new FileReader();
    reader.onload = function(e) {
        const content = e.target.result;
        parseAndPreviewData(content, file.name);
    };
    reader.readAsText(file);

    // Enable next button
    document.getElementById('step2Next').disabled = false;
}

function parseAndPreviewData(content, filename) {
    // Simplified parser - assumes CSV
    const lines = content.split('\n').filter(line => line.trim());
    const headers = lines[0].split(',');
    const rows = lines.slice(1, 6); // Show first 5 rows

    // Update table
    const headersHtml = '<tr>' + headers.map(h => `<th>${h.trim()}</th>`).join('') + '</tr>';
    document.getElementById('dataHeaders').innerHTML = headersHtml;

    const rowsHtml = rows.map(row => {
        const cells = row.split(',');
        return '<tr>' + cells.map(cell => `<td>${cell.trim()}</td>`).join('') + '</tr>';
    }).join('');
    document.getElementById('dataRows').innerHTML = rowsHtml;

    document.getElementById('rowCount').textContent = lines.length - 1;
    document.getElementById('colCount').textContent = headers.length;

    trainingData = { headers, rows: lines.slice(1) };
}

function removeFile() {
    document.getElementById('filePreview').style.display = 'none';
    document.getElementById('dataValidation').style.display = 'none';
    document.getElementById('dataFileInput').value = '';
    document.getElementById('step2Next').disabled = true;
    trainingData = null;
}

// Configuration
function updateSplitDisplay() {
    const trainValue = document.getElementById('trainSplitRange').value;
    const testValue = 100 - trainValue;
    document.getElementById('trainSplitValue').textContent = trainValue + '%';
    document.getElementById('testSplitValue').value = testValue + '%';
}

function toggleCVOptions() {
    const cvOptions = document.getElementById('cvOptions');
    cvOptions.style.display = document.getElementById('enableCV').checked ? 'block' : 'none';
}

function toggleAutoOptimization() {
    const options = document.getElementById('autoOptimizationOptions');
    options.style.display = document.getElementById('enableAutoOptimization').checked ? 'block' : 'none';
}

// Training summary
function updateTrainingSummary() {
    const modelName = selectedModel ? modelConfigurations[selectedModelCategory][selectedModel].name : 'Not selected';
    document.getElementById('summaryModel').textContent = modelName;
    document.getElementById('summaryDataset').textContent = trainingData ? `${trainingData.rows.length} rows` : 'Not loaded';
    document.getElementById('summarySplit').textContent = `${document.getElementById('trainSplitRange').value}% / ${100 - document.getElementById('trainSplitRange').value}%`;
    document.getElementById('summaryCV').textContent = document.getElementById('enableCV').checked ? `${document.getElementById('cvFolds').value}-Fold` : 'Disabled';
}

// Training simulation
function startTraining() {
    trainingActive = true;
    document.getElementById('startTrainBtn').style.display = 'none';
    document.getElementById('pauseTrainBtn').style.display = 'inline-block';
    document.getElementById('stopTrainBtn').style.display = 'inline-block';
    document.getElementById('trainingProgress').style.display = 'block';

    // Initialize chart
    initializeLossChart();

    // Add initial log
    addLog('[INFO] Starting model training...');
    addLog('[INFO] Loading training data...');

    // Simulate training
    let epoch = 0;
    const totalEpochs = 100;
    let startTime = Date.now();

    trainingInterval = setInterval(() => {
        if (!trainingActive) return;

        epoch++;
        const progress = (epoch / totalEpochs) * 100;

        // Update progress bar
        document.getElementById('currentEpoch').textContent = epoch;
        document.getElementById('totalEpochs').textContent = totalEpochs;
        document.getElementById('epochPercent').textContent = Math.round(progress);
        document.getElementById('trainingProgressBar').style.width = progress + '%';
        document.getElementById('trainingProgressBar').textContent = Math.round(progress) + '%';

        // Simulate metrics (decreasing loss, increasing accuracy)
        const trainLoss = (1.0 - (epoch / totalEpochs) * 0.9 + Math.random() * 0.1).toFixed(4);
        const valLoss = (1.0 - (epoch / totalEpochs) * 0.85 + Math.random() * 0.15).toFixed(4);
        const accuracy = ((epoch / totalEpochs) * 0.95 + Math.random() * 0.05).toFixed(2);

        document.getElementById('trainLoss').textContent = trainLoss;
        document.getElementById('valLoss').textContent = valLoss;
        document.getElementById('accuracy').textContent = (accuracy * 100).toFixed(1) + '%';

        // Update time
        const elapsed = Math.round((Date.now() - startTime) / 1000);
        document.getElementById('timeElapsed').textContent = elapsed + 's';

        // Update chart
        updateLossChart(epoch, trainLoss, valLoss);

        // Add log every 10 epochs
        if (epoch % 10 === 0) {
            addLog(`[EPOCH ${epoch}] Loss: ${trainLoss}, Val Loss: ${valLoss}, Accuracy: ${(accuracy * 100).toFixed(1)}%`);
        }

        // Check completion
        if (epoch >= totalEpochs) {
            clearInterval(trainingInterval);
            addLog('[INFO] Training completed successfully!');
            document.getElementById('pauseTrainBtn').style.display = 'none';
            document.getElementById('stopTrainBtn').style.display = 'none';
            document.getElementById('step4Next').disabled = false;
            trainingActive = false;

            // Auto-navigate to evaluation after 2 seconds
            setTimeout(() => {
                nextStep(5);
                populateEvaluationMetrics();
            }, 2000);
        }
    }, 100); // Update every 100ms
}

function pauseTraining() {
    trainingActive = false;
    addLog('[WARN] Training paused by user');
}

function stopTraining() {
    trainingActive = false;
    clearInterval(trainingInterval);
    addLog('[ERROR] Training stopped by user');
}

function initializeLossChart() {
    const ctx = document.getElementById('lossChart').getContext('2d');
    lossChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: [],
            datasets: [
                {
                    label: 'Training Loss',
                    data: [],
                    borderColor: 'rgb(75, 192, 192)',
                    backgroundColor: 'rgba(75, 192, 192, 0.1)',
                    tension: 0.4
                },
                {
                    label: 'Validation Loss',
                    data: [],
                    borderColor: 'rgb(255, 99, 132)',
                    backgroundColor: 'rgba(255, 99, 132, 0.1)',
                    tension: 0.4
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: true,
            plugins: {
                legend: {
                    display: true,
                    position: 'top'
                }
            },
            scales: {
                y: {
                    beginAtZero: false,
                    title: {
                        display: true,
                        text: 'Loss'
                    }
                },
                x: {
                    title: {
                        display: true,
                        text: 'Epoch'
                    }
                }
            }
        }
    });
}

function updateLossChart(epoch, trainLoss, valLoss) {
    if (!lossChart) return;

    lossChart.data.labels.push(epoch);
    lossChart.data.datasets[0].data.push(parseFloat(trainLoss));
    lossChart.data.datasets[1].data.push(parseFloat(valLoss));

    // Keep only last 50 points for performance
    if (lossChart.data.labels.length > 50) {
        lossChart.data.labels.shift();
        lossChart.data.datasets[0].data.shift();
        lossChart.data.datasets[1].data.shift();
    }

    lossChart.update('none'); // Update without animation for performance
}

function addLog(message) {
    const logsContainer = document.getElementById('trainingLogs');
    const logEntry = document.createElement('div');
    logEntry.className = 'log-entry';
    logEntry.textContent = message;
    logsContainer.appendChild(logEntry);

    // Auto-scroll to bottom
    logsContainer.scrollTop = logsContainer.scrollHeight;

    // Keep only last 100 log entries
    while (logsContainer.children.length > 100) {
        logsContainer.removeChild(logsContainer.firstChild);
    }
}

// Evaluation metrics
function populateEvaluationMetrics() {
    // Simulate final evaluation metrics
    document.getElementById('evalAccuracy').textContent = '94.2%';
    document.getElementById('evalPrecision').textContent = '92.8%';
    document.getElementById('evalRecall').textContent = '95.1%';
    document.getElementById('evalF1').textContent = '93.9%';
    document.getElementById('aucScore').textContent = '0.96';

    // Create evaluation charts
    createConfusionMatrix();
    createROCCurve();
    createFeatureImportance();
}

function createConfusionMatrix() {
    const ctx = document.getElementById('confusionMatrixChart').getContext('2d');
    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ['True Negative', 'False Positive', 'False Negative', 'True Positive'],
            datasets: [{
                label: 'Count',
                data: [850, 50, 80, 920],
                backgroundColor: [
                    'rgba(75, 192, 192, 0.8)',
                    'rgba(255, 99, 132, 0.8)',
                    'rgba(255, 159, 64, 0.8)',
                    'rgba(54, 162, 235, 0.8)'
                ]
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    display: false
                }
            }
        }
    });
}

function createROCCurve() {
    const ctx = document.getElementById('rocCurveChart').getContext('2d');
    const rocData = [];
    for (let i = 0; i <= 100; i++) {
        const x = i / 100;
        const y = Math.pow(x, 0.5); // Simulated ROC curve
        rocData.push({ x: x, y: y });
    }

    new Chart(ctx, {
        type: 'line',
        data: {
            datasets: [
                {
                    label: 'ROC Curve',
                    data: rocData,
                    borderColor: 'rgb(54, 162, 235)',
                    backgroundColor: 'rgba(54, 162, 235, 0.1)',
                    fill: true,
                    tension: 0.4
                },
                {
                    label: 'Random Classifier',
                    data: [{ x: 0, y: 0 }, { x: 1, y: 1 }],
                    borderColor: 'rgba(201, 203, 207, 0.5)',
                    borderDash: [5, 5],
                    fill: false
                }
            ]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    display: true
                }
            },
            scales: {
                x: {
                    type: 'linear',
                    title: {
                        display: true,
                        text: 'False Positive Rate'
                    },
                    min: 0,
                    max: 1
                },
                y: {
                    title: {
                        display: true,
                        text: 'True Positive Rate'
                    },
                    min: 0,
                    max: 1
                }
            }
        }
    });
}

function createFeatureImportance() {
    const ctx = document.getElementById('featureImportanceChart').getContext('2d');
    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ['Feature 1', 'Feature 2', 'Feature 3', 'Feature 4', 'Feature 5'],
            datasets: [{
                label: 'Importance Score',
                data: [0.35, 0.28, 0.18, 0.12, 0.07],
                backgroundColor: 'rgba(153, 102, 255, 0.8)',
                borderColor: 'rgb(153, 102, 255)',
                borderWidth: 1
            }]
        },
        options: {
            indexAxis: 'y',
            responsive: true,
            plugins: {
                legend: {
                    display: false
                }
            },
            scales: {
                x: {
                    beginAtZero: true,
                    max: 1,
                    title: {
                        display: true,
                        text: 'Importance'
                    }
                }
            }
        }
    });
}

// Model management
function saveModel() {
    const name = document.getElementById('modelName').value.trim();
    if (!name) {
        alert('Please enter a model name');
        return;
    }

    // Simulate saving
    alert(`Model "${name}" saved successfully!`);
    addToSavedModels(name);
}

function exportModel() {
    alert('Model exported! Download starting...');
}

function deployModel() {
    if (confirm('Deploy this model to production?')) {
        alert('Model deployed to production successfully!');
    }
}

function addToSavedModels(name) {
    const list = document.getElementById('savedModelsList');
    if (list.querySelector('.text-muted')) {
        list.innerHTML = '';
    }

    const modelItem = `
        <div class="list-group-item">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <strong>${name}</strong>
                    <small class="d-block text-muted">Accuracy: 94.2%</small>
                </div>
                <button class="btn btn-sm btn-primary">
                    <i class="fas fa-eye"></i>
                </button>
            </div>
        </div>
    `;
    list.innerHTML += modelItem;
}

function finishTraining() {
    if (confirm('Finish training and return to dashboard?')) {
        window.location.href = '/dashboard';
    }
}

function openModelComparison() {
    alert('Model comparison feature - compare multiple models side-by-side');
}

// System data loading
function loadSystemData() {
    const source = document.getElementById('systemDataSource').value;
    if (!source) {
        alert('Please select a data source');
        return;
    }

    // Simulate loading
    alert(`Loading ${source} data...`);
    document.getElementById('step2Next').disabled = false;
}

// API connection
document.getElementById('apiAuthMethod').addEventListener('change', function() {
    const authDetails = document.getElementById('apiAuthDetails');
    authDetails.style.display = this.value !== 'none' ? 'block' : 'none';
});

function connectToAPI() {
    const endpoint = document.getElementById('apiEndpoint').value;
    if (!endpoint) {
        alert('Please enter API endpoint URL');
        return;
    }

    // Simulate API connection
    alert('Connecting to API...');
    document.getElementById('step2Next').disabled = false;
}

</script>

<style>
/* Wizard Progress Styles */
.wizard-progress {
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: relative;
    padding: 0 2rem;
}

.wizard-progress::before {
    content: '';
    position: absolute;
    top: 20px;
    left: 10%;
    right: 10%;
    height: 2px;
    background: #dee2e6;
    z-index: 0;
}

.wizard-step {
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
    z-index: 1;
}

.wizard-step-number {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: #dee2e6;
    color: #6c757d;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    margin-bottom: 0.5rem;
    transition: all 0.3s;
}

.wizard-step.active .wizard-step-number {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    box-shadow: 0 4px 10px rgba(102, 126, 234, 0.3);
}

.wizard-step-label {
    font-size: 0.85rem;
    color: #6c757d;
    text-align: center;
}

.wizard-step.active .wizard-step-label {
    color: #667eea;
    font-weight: 600;
}

/* Model Cards */
.model-card {
    border: 2px solid #dee2e6;
    border-radius: 12px;
    padding: 1.5rem;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s;
    background: white;
    height: 100%;
}

.model-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
    border-color: #667eea;
}

.model-card.active {
    border-color: #667eea;
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
    box-shadow: 0 8px 20px rgba(102, 126, 234, 0.2);
}

.model-icon {
    margin-bottom: 1rem;
}

.model-types {
    margin-top: 1rem;
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    justify-content: center;
}

.specific-model-card {
    border: 2px solid #dee2e6;
    border-radius: 8px;
    padding: 1rem;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s;
}

.specific-model-card:hover {
    border-color: #667eea;
    background: #f8f9fa;
}

.specific-model-card.active {
    border-color: #667eea;
    background: rgba(102, 126, 234, 0.1);
}

/* Upload Zone */
.upload-zone {
    border: 2px dashed #dee2e6;
    border-radius: 12px;
    padding: 3rem 2rem;
    text-align: center;
    background: #f8f9fa;
    transition: all 0.3s;
}

.upload-zone:hover {
    border-color: #667eea;
    background: rgba(102, 126, 234, 0.05);
}

/* Validation Cards */
.validation-card {
    border: 1px solid #dee2e6;
    border-radius: 8px;
    padding: 1rem;
    text-align: center;
}

/* Training Logs */
.training-logs {
    max-height: 200px;
    overflow-y: auto;
    font-family: 'Courier New', monospace;
    font-size: 0.85rem;
    background: #1e1e1e;
    color: #00ff00;
    padding: 1rem;
    border-radius: 4px;
}

.log-entry {
    padding: 0.25rem 0;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.log-entry:last-child {
    border-bottom: none;
}

/* Metric Boxes */
.metric-box {
    background: #f8f9fa;
    border-radius: 8px;
    padding: 1rem;
    text-align: center;
}

/* Evaluation Metrics */
.evaluation-metric {
    background: white;
    border: 2px solid #dee2e6;
    border-radius: 12px;
    padding: 1.5rem;
    text-align: center;
    transition: all 0.3s;
}

.evaluation-metric:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
}

.metric-icon {
    font-size: 2rem;
    margin-bottom: 0.5rem;
}

/* Quick Tips */
.tip-item {
    padding: 0.5rem 0;
    border-bottom: 1px solid #dee2e6;
}

.tip-item:last-child {
    border-bottom: none;
}

/* Responsive */
@media (max-width: 768px) {
    .wizard-progress {
        flex-wrap: wrap;
        gap: 1rem;
    }

    .wizard-step-label {
        font-size: 0.75rem;
    }

    .model-card {
        margin-bottom: 1rem;
    }
}
</style>

{% endblock %}
